<!DOCTYPE HTML>
<html xmlns:layout="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.w3.org/1999/xhtml"
	layout:decorate="~{layouts/layout}">
<body>
	<div layout:fragment="content" th:switch="${fragment}">
		<div class="row" th:case="'viewManufactures'">
			<div th:replace="fragments/manufacture-list :: manufacture-list"></div>
		</div>
		<div class="row" th:case="'createManufacture'">
			<div th:replace="fragments/manufacture-form :: manufacture-form"></div>
		</div>
		<div class="row" th:case="'editManufacture'">
			<div th:replace="fragments/manufacture-form :: manufacture-form"></div>
		</div>
		<div class="modal fade" id="manufModel" role="dialog">
			<div class="modal-dialog modal-dialog-centered">

				<!-- Modal content-->
				<div class="modal-content">
					<div class="modal-header">
						<h4 class="modal-title">Message</h4>
						<button type="button" class="close" data-dismiss="modal">&times;</button>
					</div>
					<div class="modal-body">
						<p id="manufModelText"></p>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					</div>
				</div>

			</div>
		</div>
	</div>

	<div layout:fragment="script">
		<script th:inline="javascript">
			/*<![CDATA[*/
$(document).ready(function () { 
	$(function() {
		var datatable = $('#tblManufactureList').DataTable({
			"paging": true,
			"lengthChange": false,
			"searching": false,
			"ordering": true,
			"info": true,
			"autoWidth": false,
			"responsive": true,
			"ajax": {
				"url": "/api/manufacture/manufactureRecords",
				"dataSrc": ""
			},
			"columns": [
				{ "data": "manufactureId" },
				{ "data": "productName" },
				{ "data": "manufactureQuantity" },
				{ "data": "manufactureCost" },
				{ "data": "manufactureDateUi" },
				{
					data: null,
					className: "dt-center editor-edit",
					defaultContent: '<i class="fa fa-eye"/>',
					orderable: false
				}
			],
			"dom": '<"manuftoolbar">frtip'
		});
		$("div.manuftoolbar").html('<button id="incenseManuf" type="button" class="btn btn-block btn-info" style="width:165px;">Incense Manufacture</button>');
		// Edit record
		$('#tblManufactureList').on('click', 'td.editor-edit', function(e) {
			e.preventDefault();
			var rowData = datatable.rows(this).data();
			window.location.href = '/manufacture/editManufacture/' + rowData[0].manufactureId;
			//console.log('You clicked this' + rowData[0].purchaseId);
			//console.log(rowData[0]);
		});
		$("#incenseManuf").click(function() {
			window.location.href = '/manufacture/createIncense';
		});
		$("#cacelManufForm").click(function() {
			window.location.href = '/manufacture/viewManufactures';
		});
		$("#calCostManufBtn").click(function() {
			event.preventDefault();
			var manufactureId = document.getElementById("manufactureId").value;
			$.ajax({
				type: 'get',
				url: '/api/manufacture/findManufactureCost/' + manufactureId,
				contentType: "application/json; charset=utf-8",
				traditional: true,
				success: function(data) {
					document.getElementById("manufactureCost").value = data.manufactureCost;
					var text = data.responseMessage;
					$('#manufModelText').text(text);
					$("#manufModel").modal();
				}
			});
		});
		$("#deleteManufBtn").click(function() {
			event.preventDefault();
			var manufactureId = document.getElementById("manufactureId").value;
			$.ajax({
				type: 'delete',
				url: '/api/manufacture/deleteManufacture/' + manufactureId,
				contentType: "application/json; charset=utf-8",
				traditional: true,
				success: function(data) {
					window.location.href = '/manufacture/viewManufactures';
				}
			});
		});
		$("#pushToPurBtn").click(function() {
			event.preventDefault();
			var manufactureId = document.getElementById("manufactureId").value;
			$.ajax({
				type: 'put',
				url: '/api/manufacture/pushManufactureToPurchase/' + manufactureId,
				contentType: "application/json; charset=utf-8",
				traditional: true,
				success: function(data) {
					//window.location.href = '/manufacture/viewManufactures';
					$("#manufModel").modal();
				}
			});
		});
	});
});
			/*]]>*/
		</script>
	</div>
</body>
</html>